#===============================================================================
# System_Camera
# Edited    May 8 2020
#===============================================================================
# ██████╗  █████╗ ███╗   ███╗███████╗    ██████╗ ██╗      █████╗ ██╗   ██╗███████╗██████╗
#██╔════╝ ██╔══██╗████╗ ████║██╔════╝    ██╔══██╗██║     ██╔══██╗╚██╗ ██╔╝██╔════╝██╔══██╗
#██║  ███╗███████║██╔████╔██║█████╗      ██████╔╝██║     ███████║ ╚████╔╝ █████╗  ██████╔╝
#██║   ██║██╔══██║██║╚██╔╝██║██╔══╝      ██╔═══╝ ██║     ██╔══██║  ╚██╔╝  ██╔══╝  ██╔══██╗
#╚██████╔╝██║  ██║██║ ╚═╝ ██║███████╗    ██║     ███████╗██║  ██║   ██║   ███████╗██║  ██║
# ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝    ╚═╝     ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
class Game_Player < Game_Character

  #--------------------------------------------------------------------------
  # * initialize
  #--------------------------------------------------------------------------
  alias mscr_camera_gameplayer_initialize initialize
  def initialize(*args)
    @camera_slide_focus = 0
    mscr_camera_gameplayer_initialize(*args)
  end
  #--------------------------------------------------------------------------
  # * update_scroll
  #--------------------------------------------------------------------------
  def update_scroll(last_real_x, last_real_y)
    return if $game_map.scrolling?
    if @camera_slide_focus == 0
      screen_focus_x = screen_x
      screen_focus_y = screen_y
    else
      screen_focus_x = $game_map.events[@camera_slide_focus].screen_x
      screen_focus_y = $game_map.events[@camera_slide_focus].screen_y
    end
    sc_x = (screen_focus_x - Graphics.width/2).abs
    sc_y = (screen_focus_y - 16 - Graphics.height/2).abs
    $game_map.scroll_down(MSCR::SYS::CAMSPD*sc_y) if screen_focus_y - 16 > Graphics.height/2
    $game_map.scroll_left(MSCR::SYS::CAMSPD*sc_x) if screen_focus_x < Graphics.width/2
    $game_map.scroll_right(MSCR::SYS::CAMSPD*sc_x) if screen_focus_x > Graphics.width/2
    $game_map.scroll_up(MSCR::SYS::CAMSPD*sc_y) if screen_focus_y - 16 < Graphics.height/2
  end
  #--------------------------------------------------------------------------
  # * set_camera_focus
  #--------------------------------------------------------------------------
  def set_camera_focus(event = 0)
    @camera_slide_focus = event
  end

end

#███████╗██████╗ ██████╗ ██╗████████╗███████╗███████╗███████╗████████╗    ███╗   ███╗ █████╗ ██████╗
#██╔════╝██╔══██╗██╔══██╗██║╚══██╔══╝██╔════╝██╔════╝██╔════╝╚══██╔══╝    ████╗ ████║██╔══██╗██╔══██╗
#███████╗██████╔╝██████╔╝██║   ██║   █████╗  ███████╗█████╗     ██║       ██╔████╔██║███████║██████╔╝
#╚════██║██╔═══╝ ██╔══██╗██║   ██║   ██╔══╝  ╚════██║██╔══╝     ██║       ██║╚██╔╝██║██╔══██║██╔═══╝
#███████║██║     ██║  ██║██║   ██║   ███████╗███████║███████╗   ██║       ██║ ╚═╝ ██║██║  ██║██║
#╚══════╝╚═╝     ╚═╝  ╚═╝╚═╝   ╚═╝   ╚══════╝╚══════╝╚══════╝   ╚═╝       ╚═╝     ╚═╝╚═╝  ╚═╝╚═╝
class Spriteset_Map

  #--------------------------------------------------------------------------
  # * update_tilemap
  #--------------------------------------------------------------------------
  def update_tilemap
    @tilemap.map_data = $game_map.data
    @tilemap.ox = ($game_map.display_x * 32)
    @tilemap.oy = ($game_map.display_y * 32)
    @tilemap.ox += 1 if $game_map.adjust_tile_slide_x
    @tilemap.oy += 1 if $game_map.adjust_tile_slide_y
    @tilemap.update
  end

end

# ██████╗  █████╗ ███╗   ███╗███████╗    ███╗   ███╗ █████╗ ██████╗
#██╔════╝ ██╔══██╗████╗ ████║██╔════╝    ████╗ ████║██╔══██╗██╔══██╗
#██║  ███╗███████║██╔████╔██║█████╗      ██╔████╔██║███████║██████╔╝
#██║   ██║██╔══██║██║╚██╔╝██║██╔══╝      ██║╚██╔╝██║██╔══██║██╔═══╝
#╚██████╔╝██║  ██║██║ ╚═╝ ██║███████╗    ██║ ╚═╝ ██║██║  ██║██║
# ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝    ╚═╝     ╚═╝╚═╝  ╚═╝╚═╝
class Game_Map

  #--------------------------------------------------------------------------
  # * adjust_tile_slide_x
  #--------------------------------------------------------------------------
  def adjust_tile_slide_x
    @display_x != 0 && @display_x != (@map.width - screen_tile_x) && !scrolling?
  end
  #--------------------------------------------------------------------------
  # * adjust_tile_slide_y
  #--------------------------------------------------------------------------
  def adjust_tile_slide_y
    @display_y != 0 && @display_y != (@map.height - screen_tile_y) && !scrolling?
  end

end

# ██████╗  █████╗ ███╗   ███╗███████╗    ██╗███╗   ██╗████████╗███████╗██████╗ ██████╗ ██████╗ ███████╗████████╗███████╗██████╗
#██╔════╝ ██╔══██╗████╗ ████║██╔════╝    ██║████╗  ██║╚══██╔══╝██╔════╝██╔══██╗██╔══██╗██╔══██╗██╔════╝╚══██╔══╝██╔════╝██╔══██╗
#██║  ███╗███████║██╔████╔██║█████╗      ██║██╔██╗ ██║   ██║   █████╗  ██████╔╝██████╔╝██████╔╝█████╗     ██║   █████╗  ██████╔╝
#██║   ██║██╔══██║██║╚██╔╝██║██╔══╝      ██║██║╚██╗██║   ██║   ██╔══╝  ██╔══██╗██╔═══╝ ██╔══██╗██╔══╝     ██║   ██╔══╝  ██╔══██╗
#╚██████╔╝██║  ██║██║ ╚═╝ ██║███████╗    ██║██║ ╚████║   ██║   ███████╗██║  ██║██║     ██║  ██║███████╗   ██║   ███████╗██║  ██║
# ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝    ╚═╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝     ╚═╝  ╚═╝╚══════╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
class Game_Interpreter

  #--------------------------------------------------------------------------
  # * camfoc
  #--------------------------------------------------------------------------
  def camfoc(event = 0)
    $game_player.set_camera_focus(event)
  end

end
